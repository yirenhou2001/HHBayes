% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/utils.R
\name{running_parameter_estimation}
\alias{running_parameter_estimation}
\title{Run penalized maximum likelihood parameter estimation}
\usage{
running_parameter_estimation(
  long_dt,
  n_runs,
  start_par = NULL,
  lambda,
  lambda0,
  lambda_alpha,
  delta0_true,
  alpha0_true,
  comm_covariate_cols = NULL,
  hh_covariate_cols = NULL,
  hh_by_role = FALSE,
  hh_role_covariate_cols = NULL,
  standardize_covariates = FALSE,
  lambda_comm = lambda,
  lambda_hh = lambda,
  verbose = TRUE
)
}
\arguments{
\item{long_dt}{data.table or data.frame. Person day data from \code{\link{build_person_day_table}}.}

\item{n_runs}{Integer. Number of optimization runs for multi start.}

\item{start_par}{Numeric vector or \code{NULL}. Initial parameters. If \code{NULL},
a vector of the correct length is initialized with \code{delta0_true} and \code{alpha0_true}
in the intercept slots and zeros elsewhere.}

\item{lambda}{Numeric. Base L2 penalty on \code{gamma} age effects and \code{z_*} role offsets.}

\item{lambda0, lambda_alpha}{Numeric. Penalty strengths that pull \code{delta0} and \code{alpha0}
toward \code{delta0_true} and \code{alpha0_true}.}

\item{delta0_true, alpha0_true}{Numeric anchors for the intercept penalties on the logit scale.}

\item{comm_covariate_cols}{Character vector of community risk covariate names with no intercept.}

\item{hh_covariate_cols}{Character vector of household covariates shared across roles.}

\item{hh_by_role}{Logical. If \code{TRUE}, allow role specific household covariates through
\code{hh_role_covariate_cols}.}

\item{hh_role_covariate_cols}{Named list with elements \code{infant}, \code{sibling}, \code{adult}, \code{elder}
that give covariate names per role. Falls back to \code{hh_covariate_cols} if a role list is missing.}

\item{standardize_covariates}{Logical. Z score non binary numeric columns in model matrices.}

\item{lambda_comm, lambda_hh}{Numeric. L2 penalties for community and household covariate coefficients.}

\item{verbose}{Logical. If \code{TRUE}, print notes on dropped or unknown covariates and initialization.}
}
\value{
A numeric matrix of dimension \code{n_runs} by \code{n_parameters} with column names that match
the parameter layout, for example \code{delta0}, \code{gamma2}, \code{alpha0}, \code{z_sib}, and \code{theta_*}.
}
\description{
Repeats optimization \code{n_runs} times from jittered starts to estimate
community and household transmission parameters with optional covariate effects
and quadratic penalties.
}
